<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="RpAsignaturasMayorSancionados" language="groovy" pageWidth="612" pageHeight="792" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="67"/>
	<style name="table">
		<box>
			<pen lineWidth="1.0" lineColor="#0033FF"/>
		</box>
	</style>
	<style name="table_TH" mode="Opaque" backcolor="#00BFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#0033FF"/>
		</box>
	</style>
	<style name="table_CH" mode="Opaque" backcolor="#BFEFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#0033FF"/>
		</box>
	</style>
	<style name="table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#0033FF"/>
		</box>
	</style>
	<subDataset name="Table Dataset 1" />
	<subDataset name="dataset1" />
	<subDataset name="dataset2"/>
	<parameter name="varcod1" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="varcod2" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="varprograma" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select * from (Select b.nombre_asignatura, b.cantidadSancionados, b.lapso, rank()  OVER (PARTITION BY b.lapso ORDER BY b.cantidadSancionados DESC)
from (SELECT a.nombre_asignatura, count(aes.cedula_estudiante) as cantidadSancionados, aes.codigo_lapso as lapso
      from asignatura as a, asignatura_estudiante_sancionado as aes,
      programa_academico as p where p.id_programa= a.id_programa and aes.codigo_asignatura= a.codigo_asignatura and a.id_programa= $P{varprograma}
and aes.codigo_lapso between $P{varcod1} and $P{varcod2}
group by  aes.codigo_asignatura, a.nombre_asignatura, aes.codigo_lapso
order by cantidadSancionados desc) as b order by b.lapso asc) sub_query WHERE rank <= 5;]]>
	</queryString>
	<field name="nombre_asignatura" class="java.lang.String"/>
	<field name="cantidadsancionados" class="java.lang.Long"/>
	<field name="lapso" class="java.lang.String"/>
	<field name="rank" class="java.lang.Long"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="188" splitType="Stretch">
			<image>
				<reportElement x="0" y="0" width="575" height="83" />
				<imageExpression><![CDATA["C:\\Reportes\\ImageReporte\\cabecera-reporte.jpg"]]></imageExpression>
			</image>
			<staticText>
				<reportElement x="135" y="84" width="291" height="72" />
				<text><![CDATA[           REPÃšBLICA BOLIVARIANA DE VENEZUELA
UNIVERSIDAD CENTROCCIDENTAL LISANDRO ALVARADO
           DECANATO DE CIENCIAS Y TECNOLOGIA
]]></text>
			</staticText>
			<staticText>
				<reportElement x="112" y="135" width="336" height="43" />
				<textElement textAlignment="Center">
					<font size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[REPORTE ASIGNATURAS CON MAYOR CANTIDAD DE SANCIONADOS]]></text>
			</staticText>
			<image>
				<reportElement x="0" y="78" width="100" height="100" />
				<imageExpression><![CDATA["C:\\Reportes\\ImageReporte\\LOGO-UCLA.jpg"]]></imageExpression>
			</image>
			<image>
				<reportElement x="455" y="82" width="100" height="100" />
				<imageExpression><![CDATA["C:\\Reportes\\ImageReporte\\logo-decanato.jpg"]]></imageExpression>
			</image>
		</band>
	</title>
	<columnHeader>
		<band height="31" splitType="Stretch">
			<staticText>
				<reportElement x="138" y="8" width="115" height="20" />
				<textElement textAlignment="Center">
					<font fontName="SansSerif" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[Asignaturas]]></text>
			</staticText>
			<staticText>
				<reportElement x="342" y="6" width="131" height="20" />
				<textElement>
					<font fontName="SansSerif" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[Cantidad Sancionados]]></text>
			</staticText>
			<line>
				<reportElement x="-20" y="22" width="612" height="1" />
			</line>
			<line>
				<reportElement x="-20" y="28" width="612" height="1" />
			</line>
		</band>
	</columnHeader>
	<detail>
		<band height="24" splitType="Stretch">
			<textField>
				<reportElement x="155" y="4" width="100" height="20" />
				<textFieldExpression><![CDATA[$F{nombre_asignatura}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="395" y="4" width="100" height="20" />
				<textFieldExpression><![CDATA[$F{cantidadsancionados}]]></textFieldExpression>
			</textField>
			<componentElement>
				<reportElement x="92" y="0" width="396" height="24" />
				<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
					<datasetRun subDataset="dataset2" uuid="d98bacef-f5ec-4736-b7cc-8f102b13f99b">
						<dataSourceExpression><![CDATA[new net.sf.jasperreports.engine.JREmptyDataSource(1)]]></dataSourceExpression>
					</datasetRun>
					<jr:listContents height="24" width="396"/>
				</jr:list>
			</componentElement>
		</band>
	</detail>
	<pageFooter>
		<band height="58" splitType="Stretch">
			<image>
				<reportElement x="0" y="23" width="555" height="35" />
				<imageExpression><![CDATA["C:\\Reportes\\ImageReporte\\pie-reporte.jpg"]]></imageExpression>
			</image>
			<textField>
				<reportElement x="0" y="4" width="515" height="13" />
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="515" y="4" width="40" height="13" />
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="0" y="4" width="100" height="13" />
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band height="287" splitType="Stretch">
			<rectangle>
				<reportElement x="77" y="16" width="438" height="227" />
			</rectangle>
			<elementGroup>
				<barChart>
					<chart theme="default">
						<reportElement x="92" y="45" width="403" height="181" />
						<chartTitle/>
						<chartSubtitle/>
						<chartLegend/>
					</chart>
					<categoryDataset>
						<categorySeries>
							<seriesExpression><![CDATA[$F{nombre_asignatura}]]></seriesExpression>
							<categoryExpression><![CDATA[$F{lapso}]]></categoryExpression>
							<valueExpression><![CDATA[$F{cantidadsancionados}]]></valueExpression>
						</categorySeries>
					</categoryDataset>
					<barPlot>
						<plot/>
						<itemLabel/>
						<categoryAxisFormat>
							<axisFormat/>
						</categoryAxisFormat>
						<valueAxisFormat>
							<axisFormat/>
						</valueAxisFormat>
					</barPlot>
				</barChart>
			</elementGroup>
		</band>
	</summary>
</jasperReport>
